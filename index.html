<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pakisa Floor Check</title>

<style>
:root {
  --navy:#072760;
  --sky:#0F99DA;
  --gold:#DEB657;
  --bg:#f5f7fa;
}

body {
  margin:0;
  padding:16px;
  font-family:Inter,Arial,sans-serif;
  background:var(--bg);
}

.container {
  max-width:900px;
  margin:auto;
}

.card {
  background:#fff;
  padding:18px;
  border-radius:14px;
  box-shadow:0 6px 24px rgba(0,0,0,.08);
}

.login-row {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-bottom:14px;
}

.login-btn {
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  padding:14px;
  border-radius:12px;
  font-weight:600;
  text-decoration:none;
  color:#fff;
}

.client { background:var(--sky); }
.agent { background:var(--navy); }

h1 {
  margin:8px 0 12px;
  color:var(--navy);
}

label {
  font-size:13px;
  font-weight:600;
  margin-top:12px;
  display:block;
}

input {
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #e5e7eb;
  font-size:16px;
}

.item {
  margin-top:8px;
  padding:12px;
  border-radius:10px;
  border:1px solid #e5e7eb;
  background:#fff;
}

.small {
  font-size:12px;
  color:#6b7280;
}

footer {
  text-align:center;
  margin-top:16px;
  font-size:12px;
  color:#6b7280;
}
</style>
</head>

<body>
<div class="container">
  <div class="card">

    <div class="login-row">
      <a class="login-btn client" href="client-login.html">ðŸ‘¤ Client Login</a>
      <a class="login-btn agent" href="agent-login.html">ðŸ§¾ Agent Login</a>
    </div>

    <h1>Track Your Waybill</h1>

    <label>Search Waybill</label>
    <input id="search" placeholder="Enter waybill number" onkeyup="render()">

    <div id="list" class="small">Loading latest scansâ€¦</div>

  </div>

  <footer>Pakisa Express Logistics</footer>
</div>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = YOUR_FIREBASE_CONFIG;
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let scans = [];

async function loadScans() {
  const q = query(collection(db, "scans"), orderBy("timestamp", "desc"));
  const snap = await getDocs(q);
  scans = snap.docs.map(d => d.data());
  render();
}

window.render = function () {
  const list = document.getElementById("list");
  const term = document.getElementById("search").value.trim();

  let data = scans;

  if (term) {
    data = scans.filter(s =>
      s.waybill?.toLowerCase().includes(term.toLowerCase())
    );
  } else {
    data = scans.slice(0, 5); // ONLY latest 5
  }

  if (!data.length) {
    list.innerHTML = "<i>No results found</i>";
    return;
  }

  list.innerHTML = data.map(s => `
    <div class="item">
      <b>${s.waybill}</b><br>
      ${s.status || "Scanned"}<br>
      <span class="small">${new Date(s.timestamp?.seconds * 1000).toLocaleString()}</span>
    </div>
  `).join("");
};

loadScans();
</script>
</body>
</html>
